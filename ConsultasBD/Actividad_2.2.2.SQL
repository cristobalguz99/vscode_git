--CASO 1
SELECT TO_CHAR(C.NUMRUN,'09G999G999')||'-'||C.DVRUN AS "RUN CLIENTE",
INITCAP(C.PNOMBRE)||' '||INITCAP(C.SNOMBRE)||' '||INITCAP(C.APPATERNO)||' '||INITCAP(C.APMATERNO) AS "NOMBRE CLIENTE",
PO.NOMBRE_PROF_OFIC AS "PROFESION/OFICIO",
TO_CHAR(C.FECHA_NACIMIENTO,'DD')||' de '||TO_CHAR(C.FECHA_NACIMIENTO,'month') AS "FECHA NACIMIENTO"
FROM CLIENTE C
JOIN PROFESION_OFICIO PO ON PO.COD_PROF_OFIC = C.COD_PROF_OFIC
WHERE EXTRACT(MONTH FROM C.FECHA_NACIMIENTO) = 9
--WHERE EXTRACT(MONTH FROM C.FECHA_NACIMIENTO) = (EXTRACT(MONTH FROM SYSDATE))+1
ORDER BY "FECHA NACIMIENTO" ASC, C.APPATERNO;

--CASO 2
SELECT TO_CHAR(C.NUMRUN,'09G999G999')||'-'||C.DVRUN AS "RUN CLIENTE",
C.PNOMBRE||' '||C.SNOMBRE||' '||C.APPATERNO||' '||C.APMATERNO AS "NOMBRE CLIENTE",
TO_CHAR(SUM(CC.MONTO_SOLICITADO),'$99G999G999') AS "MONTO SOLICITADO",
TO_CHAR((SUM(CC.MONTO_SOLICITADO)/100000)*1200,'$99G999G999') AS "TOTAL PESOS TODOSUMA"
FROM CLIENTE C
JOIN CREDITO_CLIENTE CC ON CC.NRO_CLIENTE = C.NRO_CLIENTE
WHERE EXTRACT(YEAR FROM CC.FECHA_SOLIC_CRED) = EXTRACT(YEAR FROM SYSDATE)-1
GROUP BY C.NUMRUN, C.DVRUN, C.PNOMBRE,C.SNOMBRE,C.APPATERNO,C.APMATERNO
ORDER BY "TOTAL PESOS TODOSUMA" ASC, APPATERNO DESC;

--CASO 3
SELECT TO_CHAR(CC.FECHA_SOLIC_CRED,'mmyyyy') AS "MES TRANSACCION",
C.NOMBRE_CREDITO AS "TIPO CREDITO",
SUM(MONTO_CREDITO) AS "MONTO SOLICITADO CREDITO",
CASE WHEN SUM(MONTO_CREDITO) BETWEEN 100000 AND 1000000 THEN SUM(MONTO_CREDITO)*0.01
WHEN SUM(MONTO_CREDITO) BETWEEN 1000001 AND 2000000 THEN SUM(MONTO_CREDITO)*0.02
WHEN SUM(MONTO_CREDITO) BETWEEN 2000001 AND 4000000 THEN SUM(MONTO_CREDITO)*0.03
WHEN SUM(MONTO_CREDITO) BETWEEN 4000001 AND 6000000 THEN SUM(MONTO_CREDITO)*0.04
WHEN SUM(MONTO_CREDITO) > 6000000 THEN SUM(MONTO_CREDITO)*0.07
END "APORTE A LA SBIF"
FROM CREDITO_CLIENTE CC
JOIN CREDITO C ON C.COD_CREDITO = CC.COD_CREDITO
WHERE EXTRACT(YEAR FROM FECHA_SOLIC_CRED) = EXTRACT(YEAR FROM SYSDATE)-1
GROUP BY TO_CHAR(CC.FECHA_SOLIC_CRED,'mmyyyy'),C.NOMBRE_CREDITO
ORDER BY "MES TRANSACCION","TIPO CREDITO"

--